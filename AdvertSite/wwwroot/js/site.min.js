function postComment(n){n.preventDefault();let t=window.location.href.split("/"),i=t[t.length-1];return fetch("/Comment/CreateAjax?"+$.param({Id:i,"Comment.Text":document.getElementById("Comment.Text").value}),{credentials:"include",method:"POST"}).then(n=>{n.status==200&&getComments(i).then(n=>{$.ready.then(()=>{appendComments(n)})})}).catch(n=>{console.log(n)}),!1}function deleteComment(n){let i=window.location.href,t=i.split("/"),r=t[t.length-1];fetch("/Comment/Delete/"+n.target.value,{credentials:"include",method:"POST"}).then(n=>{n.status==200&&getComments(r).then(n=>{$.ready.then(()=>{appendComments(n)})})}).catch(n=>{console.log(n)})}function getComments(n){return new Promise(t=>{fetch("/Comment/GetComments?"+$.param({listingId:n}),{credentials:"include",method:"GET"}).then(n=>{n.status==200&&n.json().then(n=>{t(n)})}).catch(n=>{console.log(n)})})}function appendComments(n){let t="";n.forEach(n=>{t+=n.canDelete?`<dt>${n.userName}</dt><dt>${n.date.split("T")[0]+" "+n.date.split("T")[1].substring(0,8)}</dt><dd>${n.text} <button class='btn btn-danger' onclick='deleteComment(event)' value='${n.id}'>Å alinti</button></dd>`:`<dt>${n.userName}</dt><dt>${n.date.split("T")[0]+" "+n.date.split("T")[1].substring(0,8)}</dt><dd>${n.text} </dd>`});let i=document.getElementById("commentList");while(i.firstChild)i.removeChild(i.firstChild);$("#comment-count").empty().append(n.length);$("#commentList").append(t)}if(window.location.href.includes("Listings/Details")){let n=window.location.href.split("/"),t=n[n.length-1];getComments(t).then(n=>{$.ready.then(()=>{appendComments(n)})})}$("#nav-listings").click(()=>{localStorage.removeItem("category"),localStorage.removeItem("subcategory")});